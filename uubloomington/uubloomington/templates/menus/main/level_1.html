{% load menu_tags %}

<ul class="nav">
    {% for item in menu_items %}
        <li class="{{ item.active_class }}">
            {% if item.has_children_in_menu %}
                <a href="{{ item.href }}" _="on click toggle .expand on closest <li/>
                                             then add .clicked to closest <li/>
                                             then remove .expand from <.nav > li:not(.clicked)/>
                                             then remove .clicked from closest <li/>
                                             then halt">
                    {{ item.text }}
                </a>
                {% sub_menu item %}
            {% else %}
                <a href="{{ item.href }}">
                    {{ item.text }}
                </a>
            {% endif %}
        </li>
    {% endfor %}
</ul>

{#then repeat for item in beep! <.nav > li/>#}
{#                                               if beep! item does not match .clicked#}
{#                                                 remove .expand from item#}
{#                                               then remove .clicked from item#}
{#                                               then add .sidebar to item#}